<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>BUUCTF crypto 1 | Afan's blog</title><meta name="author" content="Afan Chen"><meta name="copyright" content="Afan Chen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="感覺CTF題目寫過就忘記，真的要把題解好好寫下來，之後要用到的時候直接查詢就好。 記憶力有點靠不住了，然後這邊只會提供做法，盡量不提供flag，不好意思。  BUUCTF 因為感覺比較油一點就來試試看。  MD5 這題給出e00cf25ad42683b3df678c61f42c6bda這個字串，依據題目來看就是MD5解密。  MD5訊息摘要演算法（MD5 Message-Digest Algori">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF crypto 1">
<meta property="og:url" content="https://afan0918.github.io/ctf-crypto-buuctf-1/index.html">
<meta property="og:site_name" content="Afan&#39;s blog">
<meta property="og:description" content="感覺CTF題目寫過就忘記，真的要把題解好好寫下來，之後要用到的時候直接查詢就好。 記憶力有點靠不住了，然後這邊只會提供做法，盡量不提供flag，不好意思。  BUUCTF 因為感覺比較油一點就來試試看。  MD5 這題給出e00cf25ad42683b3df678c61f42c6bda這個字串，依據題目來看就是MD5解密。  MD5訊息摘要演算法（MD5 Message-Digest Algori">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/eiko.jpg">
<meta property="article:published_time" content="2022-05-24T00:45:48.000Z">
<meta property="article:modified_time" content="2022-05-25T15:32:32.108Z">
<meta property="article:author" content="Afan Chen">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/eiko.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://afan0918.github.io/ctf-crypto-buuctf-1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-8282127876876574',
  enable_page_level_ads: 'true'
});</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查詢的內容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '複製成功',
    error: '複製錯誤',
    noSupport: '瀏覽器不支援'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '剛剛',
    min: '分鐘前',
    hour: '小時前',
    day: '天前',
    month: '個月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUUCTF crypto 1',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-25 23:32:32'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.css" integrity="sha384-bsHo4/LA+lkZv61JspMDQB9QP1TtO4IgOf2yYS+J6VdAYLVyx1c3XKcsHh0Vy8Ws" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js" integrity="sha384-4z8mjH4yIpuK9dIQGR1JwbrfYsStrNK6MP+2Enhue4eyo0XlBDXOIPc8b6ZU0ajz" crossorigin="anonymous"></script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">載入中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/70462625?v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 關於</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/eiko.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Afan's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜尋</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 關於</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF crypto 1</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">發表於</span><time class="post-meta-date-created" datetime="2022-05-24T00:45:48.000Z" title="發表於 2022-05-24 08:45:48">2022-05-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新於</span><time class="post-meta-date-updated" datetime="2022-05-25T15:32:32.108Z" title="更新於 2022-05-25 23:32:32">2022-05-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUUCTF crypto 1"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">閱讀量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>感覺CTF題目寫過就忘記，真的要把題解好好寫下來，之後要用到的時候直接查詢就好。<br />
記憶力有點靠不住了，然後這邊只會提供做法，盡量不提供flag，不好意思。</p>
<h2 id="buuctf"><a class="markdownIt-Anchor" href="#buuctf"></a> BUUCTF</h2>
<p>因為感覺比較油一點就來試試看。</p>
<h3 id="md5"><a class="markdownIt-Anchor" href="#md5"></a> MD5</h3>
<p>這題給出e00cf25ad42683b3df678c61f42c6bda這個字串，依據題目來看就是MD5解密。</p>
<blockquote>
<p>MD5訊息摘要演算法（MD5 Message-Digest Algorithm），是一種被廣泛使用的密碼雜湊函式，可以產生出一個128位元（16個字元(BYTES)）的雜湊值（hash value），用於確保資訊傳輸完整一致，由美國密碼學家羅納德·李維斯特（Ronald Linn Rivest）設計。</p>
</blockquote>
<p>網站提供的是與資料庫內的數據進行比較並解密，畢竟不可能從hash中直接獲得明文。</p>
<p><a target="_blank" rel="noopener" href="https://md5decrypt.net/en/">https://md5decrypt.net/en/</a></p>
<p>輸入後即可取得flag。</p>
<h3 id="一眼就解密"><a class="markdownIt-Anchor" href="#一眼就解密"></a> 一眼就解密</h3>
<p>題目給出的加密字串是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ZmxhZ3tUSEVfRkxBR19PRl9USElTX1NUUklOR30=</span><br></pre></td></tr></table></figure>
<p>看到字尾有=可以先盲猜是base64，熟到不能再熟了。<br />
decode base64 to ascii編碼之後，得到flag。</p>
<h3 id="url編碼"><a class="markdownIt-Anchor" href="#url編碼"></a> Url編碼</h3>
<p>既然提示出是url編碼了，就找一個解url編碼的網站。</p>
<p><a target="_blank" rel="noopener" href="https://www.ifreesite.com/urldecoderencoder.htm">https://www.ifreesite.com/urldecoderencoder.htm</a></p>
<p>解碼後取得flag。</p>
<h3 id="看我迴旋踢"><a class="markdownIt-Anchor" href="#看我迴旋踢"></a> 看我迴旋踢</h3>
<p>題目給出的加密字串是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">synt&#123;5pq1004q-86n5-46q8-o720-oro5on0417r1&#125;</span><br></pre></td></tr></table></figure>
<p>感覺沒什麼特別的地方，也不是hex等字串的感覺，先盲猜ROT13，然後發現解密出的字串格式是flag{…}，確定取得flag。</p>
<h3 id="摩絲"><a class="markdownIt-Anchor" href="#摩絲"></a> 摩絲</h3>
<p>厲害了，直接打開維基百科查詢，對密碼對到眼睛瞎掉。<br />
不過比較好的是密碼中間有用空格隔開，不然真的很噁。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.. .-.. --- ...- . -.-- --- ..-</span><br></pre></td></tr></table></figure>
<p>翻譯過來是I LOVE YOU，提交還要大寫，不要臉。</p>
<h3 id="password"><a class="markdownIt-Anchor" href="#password"></a> password</h3>
<p>原本又HxD等等軟體都打不開，想說這到底是什麼，沒想到notepad++直接打開，使用字元集GB2312來進行解碼之後可以觀看。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">姓名：张三 </span><br><span class="line">生日：19900315</span><br><span class="line"></span><br><span class="line">key格式为key&#123;xxxxxxxxxx&#125;</span><br></pre></td></tr></table></figure>
<p>要填入十個數字，猜測應該是姓名加上生日，但沒想到是縮寫，厲害了羅馬拼音。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;zs19900315&#125;</span><br></pre></td></tr></table></figure>
<h3 id="變異凱撒"><a class="markdownIt-Anchor" href="#變異凱撒"></a> 變異凱撒</h3>
<p>原本以為就是ROT13的變形，結果沒想到列出所有組合都怪怪的，然後去找了一下^，確認他在ASCII裡面。</p>
<p>然後可以看到一些規律。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a+5=f</span><br><span class="line">f+6=l</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>然後直接解碼就好，取得flag。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">caesar</span>(<span class="params">cipher</span>):</span><br><span class="line">    j = <span class="number">5</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> cipher:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i) + j), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">caesar(<span class="string">&quot;afZ_r9VYfScOeO_UL^RWUc&quot;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="quoted-printable"><a class="markdownIt-Anchor" href="#quoted-printable"></a> Quoted-printable</h3>
<p>題目給的密文是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">=E9=82=A3=E4=BD=A0=E4=B9=9F=E5=BE=88=E6=A3=92=E5=93=A6</span><br></pre></td></tr></table></figure>
<p>先查詢Quoted-printable是什麼東西，發現維基百科的定義如下。</p>
<blockquote>
<p>Quoted-printable或QP encoding，沒有規範的中文譯名，可譯為可列印字元參照編碼或使用可列印字元的編碼。Quoted-printable是使用可列印的ASCII字元（如字母、數字與「=」）表示各種編碼格式下的字元，以便能在7-bit資料通路上傳輸8-bit資料, 或者更一般地說在非8-bit clean媒體上正確處理資料。這被定義為MIME content transfer encoding，用於e-mail。</p>
</blockquote>
<p>以此網站進行decoder即可取得flag內容。</p>
<p><a target="_blank" rel="noopener" href="https://www.webatic.com/quoted-printable-convertor">https://www.webatic.com/quoted-printable-convertor</a></p>
<h3 id="rabbit"><a class="markdownIt-Anchor" href="#rabbit"></a> Rabbit</h3>
<p>題目給的密文是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">U2FsdGVkX1/+ydnDPowGbjjJXhZxm2MP2AgI</span><br></pre></td></tr></table></figure>
<p>先查詢Rabbit密碼是什麼東西，網路上的資訊如下。</p>
<blockquote>
<p>Rabbit流密碼是由Cryptico公司（<a target="_blank" rel="noopener" href="http://www.cryptico.com">http://www.cryptico.com</a> ）設計的，金鑰長度128位，<br />
最大加密訊息長度為264 Bytes，即16 TB，若訊息超過該長度，則需要更換金鑰對剩下的訊息進行處理。它是目前安全性較高，加/解密速度比較高效的流密碼之一，在各種處理器平臺上都有不凡的表現。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="http://tools.jb51.net/password/rabbit_encode">http://tools.jb51.net/password/rabbit_encode</a></p>
<p>使用此網站進行解碼即可取得flag。</p>
<h3 id="籬笆牆的影子"><a class="markdownIt-Anchor" href="#籬笆牆的影子"></a> 籬笆牆的影子</h3>
<p>題目給的密文是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">felhaagv&#123;ewtehtehfilnakgw&#125;</span><br></pre></td></tr></table></figure>
<p>題目給出的題示是 :<br />
星星還是那顆星星喲<br />
月亮還是那個月亮<br />
山也還是那座山喲<br />
梁也還是那道梁<br />
碾子是碾子缸是缸喲<br />
爹是爹來娘是娘<br />
麻油燈呵還吱吱響<br />
點的還是那麼丁點亮<br />
哦哦</p>
<p>完全…看不懂，查詢之後發現是歌詞。</p>
<p>哭阿，方向完全錯了，這是柵欄密碼。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">felhaagv&#123;ewtehtehfilnakgw&#125;</span><br><span class="line">f l a g &#123; w e t h i n k w</span><br><span class="line"> e h a v e t h e f l a g &#125;</span><br></pre></td></tr></table></figure>
<p>於是可以用這種簡單的方法解出flag{wethinkwehavetheflag}</p>
<p>爛死了。</p>
<h3 id="丟失的md5"><a class="markdownIt-Anchor" href="#丟失的md5"></a> 丟失的MD5</h3>
<p>題目給出一個py檔。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib   </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            m=hashlib.md5()</span><br><span class="line">            m.update(<span class="string">&#x27;TASC&#x27;</span>+<span class="built_in">chr</span>(i)+<span class="string">&#x27;O3RJMV&#x27;</span>+<span class="built_in">chr</span>(j)+<span class="string">&#x27;WDJKX&#x27;</span>+<span class="built_in">chr</span>(k)+<span class="string">&#x27;ZM&#x27;</span>)</span><br><span class="line">            des=m.hexdigest()</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;e9032&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;da&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;911513&#x27;</span> <span class="keyword">in</span> des:</span><br><span class="line">                <span class="built_in">print</span>(des)</span><br></pre></td></tr></table></figure>
<p>嘗試運行後發現被提示需要編碼，修正後讓他可以運行。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib   </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            m=hashlib.md5()</span><br><span class="line">            m.update(<span class="built_in">str</span>(<span class="string">&#x27;TASC&#x27;</span>+<span class="built_in">chr</span>(i)+<span class="string">&#x27;O3RJMV&#x27;</span>+<span class="built_in">chr</span>(j)+<span class="string">&#x27;WDJKX&#x27;</span>+<span class="built_in">chr</span>(k)+<span class="string">&#x27;ZM&#x27;</span>).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">            des=m.hexdigest()</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;e9032&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;da&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;911513&#x27;</span> <span class="keyword">in</span> des:</span><br><span class="line">                <span class="built_in">print</span>(des)</span><br></pre></td></tr></table></figure>
<p>執行後獲得</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e9032994dabac08080091151380478a2</span><br></pre></td></tr></table></figure>
<p>感覺是hex(十六進位)，但丟進去decoder成ascii和base64都不太對的感覺。<br />
然後發現自己是笨蛋，題目就說他是MD5，啊我怎麼沒感覺。</p>
<p>最後發現這就是答案了，哭阿哭阿，我是笨蛋。</p>
<h3 id="rsa"><a class="markdownIt-Anchor" href="#rsa"></a> RSA</h3>
<p>p=473398607161，q=4511491，e=17，求解 d</p>
<p>使用公式解就可以了</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p =gmpy2.mpz(<span class="number">473398607161</span>)</span><br><span class="line">q =gmpy2.mpz(<span class="number">4511491</span>)</span><br><span class="line">e =gmpy2.mpz(<span class="number">17</span>)</span><br><span class="line">phi_n= (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d is:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span> (d)</span><br></pre></td></tr></table></figure>
<p>拿到flag</p>
<h3 id="alice與bob"><a class="markdownIt-Anchor" href="#alice與bob"></a> Alice與Bob</h3>
<p>密碼學歷史中，有兩位知名的傑出人物，Alice和Bob。他們的愛情經過置換和輪加密也難以混淆，即使是沒有身份認證也可以知根知底。就像在數學王國中的素數一樣，孤傲又熱情。下面是一個大整數:98554799767,請分解為兩個素數，分解後，小的放前面，大的放後面，合成一個新的數字，進行md5的32位小寫哈希，提交答案。</p>
<p>整數n小於256bit，可以透過本地工具爆破成功，直接打開RSATool2v17。</p>
<p>不然也可以使用線上工具 <a target="_blank" rel="noopener" href="http://factordb.com/">http://factordb.com/</a> 查詢。</p>
<p>爆破結果p = 101999, q = 966233</p>
<p>以 101999966233 在 <a target="_blank" rel="noopener" href="http://www.hiencode.com/hash.html">http://www.hiencode.com/hash.html</a> 這類線上工具進行MD5的hash計算，得到flag。</p>
<h3 id="rsarsa"><a class="markdownIt-Anchor" href="#rsarsa"></a> rsarsa</h3>
<p>題目:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Math is cool! Use the RSA algorithm to decode the secret message, c, p, q, and e are parameters for the RSA algorithm.</span><br><span class="line"></span><br><span class="line">p =  9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span><br><span class="line">q =  11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span><br><span class="line">e =  65537</span><br><span class="line">c =  83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span><br><span class="line"></span><br><span class="line">Use RSA to find the secret message</span><br></pre></td></tr></table></figure>
<p>利用RSATool2v17計算出d</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">d = 56632047571190660567520341028861194862411428416862507034762587229995138605649836960220619903456392752115943299335385163216233744624623848874235303309636393446736347238627793022725260986466957974753004129210680401432377444984195145009801967391196615524488853620232925992387563270746297909112117451398527453977</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">p =  <span class="number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span></span><br><span class="line">q =  <span class="number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span></span><br><span class="line">c =  <span class="number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span></span><br><span class="line">d = <span class="number">56632047571190660567520341028861194862411428416862507034762587229995138605649836960220619903456392752115943299335385163216233744624623848874235303309636393446736347238627793022725260986466957974753004129210680401432377444984195145009801967391196615524488853620232925992387563270746297909112117451398527453977</span></span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(c, d, n))</span><br></pre></td></tr></table></figure>
<p>得到flag。</p>
<h3 id="大帝的密碼武器"><a class="markdownIt-Anchor" href="#大帝的密碼武器"></a> 大帝的密碼武器</h3>
<p>看到大帝直覺又是凱薩密碼，</p>
<p>用HxD打開，看到開頭兩個字是PK，應該是zip的標示，加上副檔名.zip之後解壓縮，得到題目。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">公元前一百年，在罗马出生了一位对世界影响巨大的人物，他生前是罗马三巨头之一。他率先使用了一种简单的加密函，因此这种加密方法以他的名字命名。</span><br><span class="line">以下密文被解开后可以获得一个有意义的单词：FRPHEVGL</span><br><span class="line">你可以用这个相同的加密向量加密附件中的密文，作为答案进行提交。</span><br></pre></td></tr></table></figure>
<p>將FRPHEVGL跑25種ROT之後可以得到</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FRPHEVGL</span><br><span class="line">GSQIFWHM</span><br><span class="line">HTRJGXIN</span><br><span class="line">IUSKHYJO</span><br><span class="line">JVTLIZKP</span><br><span class="line">KWUMJALQ</span><br><span class="line">LXVNKBMR</span><br><span class="line">MYWOLCNS</span><br><span class="line">NZXPMDOT</span><br><span class="line">OAYQNEPU</span><br><span class="line">PBZROFQV</span><br><span class="line">QCASPGRW</span><br><span class="line">RDBTQHSX</span><br><span class="line">SECURITY</span><br><span class="line">TFDVSJUZ</span><br><span class="line">UGEWTKVA</span><br><span class="line">VHFXULWB</span><br><span class="line">WIGYVMXC</span><br><span class="line">XJHZWNYD</span><br><span class="line">YKIAXOZE</span><br><span class="line">ZLJBYPAF</span><br><span class="line">AMKCZQBG</span><br><span class="line">BNLDARCH</span><br><span class="line">COMEBSDI</span><br><span class="line">DPNFCTEJ</span><br></pre></td></tr></table></figure>
<p>懶得看哪個是有意義的單詞，直接丟Google翻譯，得到單詞是SECURITY，順便確定只是簡單的ROT13。<br />
然後沒找到要加密的密文在哪，後來發現SECURITY也不是密文 = =，查了一下發現大家還會拿到一個密文叫ComeChina，題目感覺出了問題，丟進ROT13，得到flag。</p>
<h3 id="windows系統密碼"><a class="markdownIt-Anchor" href="#windows系統密碼"></a> Windows系統密碼</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">ctf:1002:06af9108f2e1fecf144e2e8adef09efd:a7fcb22a88038f35a8f39d503e7f0062:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">SUPPORT_388945a0:1001:aad3b435b51404eeaad3b435b51404ee:bef14eee40dffbc345eeb3f58e290d56:::</span><br></pre></td></tr></table></figure>
<p>從 <a target="_blank" rel="noopener" href="https://www.secpulse.com/archives/65256.html">https://www.secpulse.com/archives/65256.html</a> 此篇文章可以看出windows有兩種密碼處理方式，其中NT LAN Manager（NTLM）的格式跟題目給出的格式一樣。</p>
<p>將06af9108f2e1fecf144e2e8adef09efd和a7fcb22a88038f35a8f39d503e7f0062分別丟入 <a target="_blank" rel="noopener" href="https://www.cmd5.com/">https://www.cmd5.com/</a> 後，後者可以得到有意義的flag。</p>
<h3 id="凱撒替換呵呵"><a class="markdownIt-Anchor" href="#凱撒替換呵呵"></a> 凱撒？替換？呵呵!</h3>
<p>題目給的密文如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">MTHJ&#123;CUBCGXGUGXWREXIPOYAOEYFIGXWRXCHTKHFCOHCFDUCGTXZOHIXOEOWMEHZO&#125; </span><br></pre></td></tr></table></figure>
<p>先跑過一遍凱薩密碼，感覺都不像，就改用替換密碼爆破。</p>
<p>在 <a target="_blank" rel="noopener" href="https://quipqiup.com/">https://quipqiup.com/</a> 上輸入密文和已知替換字 MTHJ=flag ，暴力破解後的第一個選項就是flag。</p>
<h3 id="萌萌噠的八戒"><a class="markdownIt-Anchor" href="#萌萌噠的八戒"></a> 萌萌噠的八戒</h3>
<p>題目無法解壓縮，用notepad++打開來看，發現是rar，改用rar解壓縮取得題目。</p>
<p><img src="https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/bajie.jpg" alt="" /></p>
<p>先看檔案內有沒有flag和隱藏的區塊，檢查之後找不到，圖片左下感覺是密碼。</p>
<p><a target="_blank" rel="noopener" href="http://www.hiencode.com/pigpen.html">http://www.hiencode.com/pigpen.html</a></p>
<p>照著輸入，取得密碼。</p>
<h3 id="rsa1"><a class="markdownIt-Anchor" href="#rsa1"></a> RSA1</h3>
<p>題目給出</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">p = 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229 </span><br><span class="line">q = 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469 </span><br><span class="line">dp = 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929 </span><br><span class="line">dq = 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041 </span><br><span class="line">c = 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span><br></pre></td></tr></table></figure>
<p>參照 <a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/19413/what-are-dp-and-dq-in-encryption-by-rsa-in-c">此論壇</a>，得知DP is d mod (p − 1), similarly DQ is d mod (q − 1).</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>e</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mspace linebreak="newline"></mspace><mi>m</mi><mo>=</mo><msup><mi>c</mi><mi>d</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mspace linebreak="newline"></mspace><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>d</mi><mi>p</mi><mo>=</mo><mi>d</mi><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>d</mi><mi>q</mi><mo>=</mo><mi>d</mi><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c = m^e mod n\newline
m = c^d mod n\newline
ϕ(n) = (p-1) * (q-1)\newline
dp = d mod (p-1)\newline
dq = d mod (q-1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">n</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">n</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϕ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
<p>要解密求出明文m，要先拿到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>c</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">c^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span></span></span>，利用中國剩餘定理，可以得到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mn>1</mn><mo>=</mo><msup><mi>c</mi><mi>d</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">m1 = c^d mod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mn>2</mn><mo>=</mo><msup><mi>c</mi><mi>d</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">m2 = c^d mod q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span>。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>p</mi><mi mathvariant="normal">−</mi><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi><mspace linebreak="newline"></mspace><mi>d</mi><mo>=</mo><mi>d</mi><mi>p</mi><mo>+</mo><mi>k</mi><mi mathvariant="normal">∗</mi><mo stretchy="false">(</mo><mi>p</mi><mi mathvariant="normal">−</mi><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>m</mi><mn>1</mn><mo>=</mo><msup><mi>c</mi><mrow><mi>d</mi><mi>q</mi></mrow></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi><mspace linebreak="newline"></mspace><mi>m</mi><mn>2</mn><mo>=</mo><msup><mi>c</mi><mrow><mi>d</mi><mi>p</mi></mrow></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi><mspace linebreak="newline"></mspace><mi>m</mi><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>m</mi><mn>2</mn><mi mathvariant="normal">　</mi><mi mathvariant="normal">−</mi><mi mathvariant="normal">　</mi><mi>m</mi><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">　</mi><mi mathvariant="normal">∗</mi><mi mathvariant="normal">　</mi><msup><mi>p</mi><mrow><mi mathvariant="normal">−</mi><mn>1</mn></mrow></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi><mo stretchy="false">)</mo><mo>∗</mo><mi mathvariant="normal">　</mi><mi>p</mi><mo>+</mo><mi>m</mi><mn>1</mn><mo stretchy="false">)</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">k(p−1) = 1 mod p\\
d = dp + k ∗ (p−1)\\
m1 = c^{dq} mod q\\
m2 = c^{dp} mod p\\
m = (((m2　−　m1)　∗　p^{−1} mod q) *　p + m1) mod n
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord">−</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord">∗</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord">−</span><span class="mord">1</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.093548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.093548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">p</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">p</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord">2</span><span class="mord cjk_fallback">　</span><span class="mord">−</span><span class="mord cjk_fallback">　</span><span class="mord mathdefault">m</span><span class="mord">1</span><span class="mclose">)</span><span class="mord cjk_fallback">　</span><span class="mord">∗</span><span class="mord cjk_fallback">　</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">　</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord">1</span><span class="mclose">)</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">n</span></span></span></span></span></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x, y, q = egcd(b, a % b)  <span class="comment"># q = GCD(a, b) = GCD(b, a%b)</span></span><br><span class="line">        x, y = y, (x - (a // b) * y)</span><br><span class="line">        <span class="keyword">return</span> x, y, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_inv</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> egcd(a, b)[<span class="number">0</span>] % b  <span class="comment"># 求a模b得逆</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line">q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line">dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line">dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line">c = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line"></span><br><span class="line">invq = mod_inv(p, q)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, dp, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, dq, q)</span><br><span class="line">m = ((mp - mq) * invq % p) * q + mq</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>
<p>然後noxCTF要代換成flag，提交拿分。</p>
<h3 id="權限獲得第一步"><a class="markdownIt-Anchor" href="#權限獲得第一步"></a> 權限獲得第一步</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Administrator:500:806EDC27AA52E314AAD3B435B51404EE:F4AD50F57683D4260DFD48AA351A17A8:::</span><br></pre></td></tr></table></figure>
<p>看題目感覺就是之前學到的windows密碼，打開 <a target="_blank" rel="noopener" href="https://www.cmd5.com/">https://www.cmd5.com/</a> ，將 F4AD50F57683D4260DFD48AA351A17A8 輸入即可取得flag。</p>
<h3 id="old-fashion"><a class="markdownIt-Anchor" href="#old-fashion"></a> old-fashion</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Os drnuzearyuwn, y jtkjzoztzoes douwlr oj y ilzwex eq lsdexosa kn pwodw tsozj eq ufyoszlbz yrl rlufydlx pozw douwlrzlbz, ydderxosa ze y rlatfyr jnjzli; mjy gfbmw vla xy wbfnsy symmyew (mjy vrwm qrvvrf), hlbew rd symmyew, mebhsymw rd symmyew, vbomgeyw rd mjy lxrzy, lfk wr dremj. Mjy eyqybzye kyqbhjyew mjy myom xa hyedrevbfn lf bfzyewy wgxwmbmgmbrf. Wr mjy dsln bw f1_2jyf-k3_jg1-vb-vl_l</span><br></pre></td></tr></table></figure>
<p>看題目感覺是詞頻分析，就直接用<a target="_blank" rel="noopener" href="https://quipqiup.com/">爆破攻擊</a>，取得flag。</p>
<h3 id="世上無難事"><a class="markdownIt-Anchor" href="#世上無難事"></a> 世上無難事</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">VIZZB IFIUOJBWO NVXAP OBC XZZ UKHVN IFIUOJBWO HB XVIXW XAW VXFI X QIXN VBD KQ IFIUOJBWO WBKAH NBWXO VBD XJBCN NKG QLKEIU DI XUI VIUI DKNV QNCWIANQ XN DXPIMKIZW VKHV QEVBBZ KA XUZKAHNBA FKUHKAKX XAW DI VXFI HBN QNCWIANQ NCAKAH KA MUBG XZZ XEUBQQ XGIUKEX MUBG PKAWIUHXUNIA NVUBCHV 12NV HUXWI XAW DI XUI SCQN QB HZXW NVXN XZZ EBCZW SBKA CQ NBWXO XAW DI DXAN NB NVXAP DXPIMKIZW MBU JIKAH QCEV XA BCNQNXAWKAH VBQN HKFI OBCUQIZFIQ X JKH UBCAW BM XLLZXCQI XAW NVI PIO KQ 640I11012805M211J0XJ24MM02X1IW09</span><br></pre></td></tr></table></figure>
<p>使用跟上題一樣的爆破攻擊，然後flag要改小寫。</p>
<h3 id="rsa3"><a class="markdownIt-Anchor" href="#rsa3"></a> RSA3</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c1=22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span><br><span class="line">n=22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span><br><span class="line">e1=11187289</span><br><span class="line">c2=18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span><br><span class="line">e2=9647291</span><br></pre></td></tr></table></figure>
<p>看題目應該是要做公共模數攻擊，假如採用兩個或者兩個以上的公鑰(N,e)來加密同一條資訊，可以得到:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c1 = pow(m, e1, N), c2 = pow(m, e2, N)</span><br></pre></td></tr></table></figure>
<p>分別拿對應的私鑰來解密，可以得到相同的明文m</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">m = pow(c1, d1, N), m = pow(c2, d2, N)</span><br></pre></td></tr></table></figure>
<p>假設已知n,e1,e2,c1,c2，即可得到明文m，因為e1和e2互質，所以使用歐幾里得演算法（找兩整數的最大公約數）可以找到能夠滿足以下條件的x，y</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pow(x,e1)+pow(y,e2)=1</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="number">20000</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, m</span>):</span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;modular inverse does not exist&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n = <span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1 = <span class="number">11187289</span></span><br><span class="line">c2 = <span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2 = <span class="number">9647291</span></span><br><span class="line"></span><br><span class="line">s = egcd(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">    s1 = - s1</span><br><span class="line">    c1 = modinv(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">    s2 = - s2</span><br><span class="line">    c2 = modinv(c2, n)</span><br><span class="line"></span><br><span class="line">m = (<span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n)) % n</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>
<p>取得flag，要注意的是過程中可能因為迭代次數過多被終止執行。</p>
<h3 id="rsa2"><a class="markdownIt-Anchor" href="#rsa2"></a> RSA2</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e = 65537</span><br><span class="line">n = 248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span><br><span class="line">dp = 905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span><br><span class="line"></span><br><span class="line">c = 140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">p = <span class="number">0</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">temp = dp * e</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">    <span class="keyword">if</span> (temp - <span class="number">1</span>) % i == <span class="number">0</span>:</span><br><span class="line">        x = (temp - <span class="number">1</span>) // i + <span class="number">1</span></span><br><span class="line">        y = n % x</span><br><span class="line">        <span class="keyword">if</span> y == <span class="number">0</span>:</span><br><span class="line">            p = x</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">q = n // p</span><br><span class="line"><span class="comment"># &#x27;//&#x27;代表向下取整,&#x27;/&#x27;得到的是浮點數</span></span><br><span class="line">d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">key = rsa.PrivateKey(n, e, d, p, q)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>
<p>取得flag。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="Afan Chen">Afan Chen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章連結: </span><span class="post-copyright-info"><a href="https://afan0918.github.io/ctf-crypto-buuctf-1/">https://afan0918.github.io/ctf-crypto-buuctf-1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版權聲明: </span><span class="post-copyright-info">本部落格所有文章除特別聲明外，均採用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 許可協議。轉載請註明來自 <a href="https://afan0918.github.io" target="_blank">Afan's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/eiko.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/ctf-crypto-buuctf-2/"><img class="prev-cover" src="https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/eiko.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">BUUCTF crypto 2</div></div></a></div><div class="next-post pull-right"><a href="/linux-shell/"><img class="next-cover" src="https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/eiko.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">linux-shell的撰寫</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 評論</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/70462625?v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Afan Chen</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/afan0918"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/afan0918" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目錄</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#buuctf"><span class="toc-text"> BUUCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#md5"><span class="toc-text"> MD5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E7%9C%BC%E5%B0%B1%E8%A7%A3%E5%AF%86"><span class="toc-text"> 一眼就解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#url%E7%B7%A8%E7%A2%BC"><span class="toc-text"> Url編碼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%8B%E6%88%91%E8%BF%B4%E6%97%8B%E8%B8%A2"><span class="toc-text"> 看我迴旋踢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%A9%E7%B5%B2"><span class="toc-text"> 摩絲</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#password"><span class="toc-text"> password</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%8A%E7%95%B0%E5%87%B1%E6%92%92"><span class="toc-text"> 變異凱撒</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#quoted-printable"><span class="toc-text"> Quoted-printable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rabbit"><span class="toc-text"> Rabbit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%AC%E7%AC%86%E7%89%86%E7%9A%84%E5%BD%B1%E5%AD%90"><span class="toc-text"> 籬笆牆的影子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%9F%E5%A4%B1%E7%9A%84md5"><span class="toc-text"> 丟失的MD5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa"><span class="toc-text"> RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#alice%E8%88%87bob"><span class="toc-text"> Alice與Bob</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsarsa"><span class="toc-text"> rsarsa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%B8%9D%E7%9A%84%E5%AF%86%E7%A2%BC%E6%AD%A6%E5%99%A8"><span class="toc-text"> 大帝的密碼武器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#windows%E7%B3%BB%E7%B5%B1%E5%AF%86%E7%A2%BC"><span class="toc-text"> Windows系統密碼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%B1%E6%92%92%E6%9B%BF%E6%8F%9B%E5%91%B5%E5%91%B5"><span class="toc-text"> 凱撒？替換？呵呵!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%90%8C%E8%90%8C%E5%99%A0%E7%9A%84%E5%85%AB%E6%88%92"><span class="toc-text"> 萌萌噠的八戒</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa1"><span class="toc-text"> RSA1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%8A%E9%99%90%E7%8D%B2%E5%BE%97%E7%AC%AC%E4%B8%80%E6%AD%A5"><span class="toc-text"> 權限獲得第一步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#old-fashion"><span class="toc-text"> old-fashion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%96%E4%B8%8A%E7%84%A1%E9%9B%A3%E4%BA%8B"><span class="toc-text"> 世上無難事</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa3"><span class="toc-text"> RSA3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa2"><span class="toc-text"> RSA2</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/ctf-crypto-buuctf-2/" title="BUUCTF crypto 2"><img src="https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/eiko.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF crypto 2"/></a><div class="content"><a class="title" href="/ctf-crypto-buuctf-2/" title="BUUCTF crypto 2">BUUCTF crypto 2</a><time datetime="2022-05-25T15:25:48.000Z" title="發表於 2022-05-25 23:25:48">2022-05-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/ctf-crypto-buuctf-1/" title="BUUCTF crypto 1"><img src="https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/eiko.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTF crypto 1"/></a><div class="content"><a class="title" href="/ctf-crypto-buuctf-1/" title="BUUCTF crypto 1">BUUCTF crypto 1</a><time datetime="2022-05-24T00:45:48.000Z" title="發表於 2022-05-24 08:45:48">2022-05-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/linux-shell/" title="linux-shell的撰寫"><img src="https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/eiko.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="linux-shell的撰寫"/></a><div class="content"><a class="title" href="/linux-shell/" title="linux-shell的撰寫">linux-shell的撰寫</a><time datetime="2022-05-23T14:30:17.000Z" title="發表於 2022-05-23 22:30:17">2022-05-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/gpu-server-command/" title="gpu server 架好之後的一些常用指令"><img src="https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/eiko.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="gpu server 架好之後的一些常用指令"/></a><div class="content"><a class="title" href="/gpu-server-command/" title="gpu server 架好之後的一些常用指令">gpu server 架好之後的一些常用指令</a><time datetime="2022-05-22T00:26:40.000Z" title="發表於 2022-05-22 08:26:40">2022-05-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/set-hexo-theme/" title="hexo-theme-butterfly 常用語法"><img src="https://raw.githubusercontent.com/afan0918/afan0918.github.io/main/asset/eiko.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="hexo-theme-butterfly 常用語法"/></a><div class="content"><a class="title" href="/set-hexo-theme/" title="hexo-theme-butterfly 常用語法">hexo-theme-butterfly 常用語法</a><time datetime="2022-05-21T02:05:01.000Z" title="發表於 2022-05-21 10:05:01">2022-05-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Afan Chen</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="閱讀模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="簡繁轉換">簡</button><button id="darkmode" type="button" title="淺色和深色模式轉換"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="單欄和雙欄切換"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="設定"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目錄"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直達評論"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到頂部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜尋</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  資料庫載入中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜尋文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>